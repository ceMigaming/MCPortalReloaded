package com.cemi.portalreloaded.entity;

import java.util.Map;

import javax.annotation.Nullable;

import com.cemi.portalreloaded.PortalReloaded;
import com.cemi.portalreloaded.client.renderer.entity.RenderEntityCube;
import com.cemi.portalreloaded.client.renderer.entity.RenderEntityHEP;
import com.cemi.portalreloaded.client.renderer.entity.RenderEntityPivotCube;
import com.cemi.portalreloaded.client.renderer.entity.RenderEntityWheatley;
import com.google.common.collect.Maps;

import net.minecraft.client.renderer.entity.Render;
import net.minecraft.client.renderer.entity.RenderManager;
import net.minecraft.entity.Entity;
import net.minecraft.entity.EntityList;
import net.minecraft.util.ResourceLocation;
import net.minecraftforge.fml.client.registry.IRenderFactory;
import net.minecraftforge.fml.client.registry.RenderingRegistry;
import net.minecraftforge.fml.common.registry.EntityEntry;
import net.minecraftforge.fml.common.registry.EntityEntryBuilder;
import net.minecraftforge.registries.IForgeRegistry;

public class PortalEntities {

	static int id = 33;

	static IForgeRegistry<EntityEntry> registry;

	public static final Map<ResourceLocation, EntityList.EntityEggInfo> CUBE_PLACERS = Maps.<ResourceLocation, EntityList.EntityEggInfo>newLinkedHashMap();
	public static final Map<ResourceLocation, EntityList.EntityEggInfo> ROBOTS_PLACERS = Maps.<ResourceLocation, EntityList.EntityEggInfo>newLinkedHashMap();

	public static void register(IForgeRegistry<EntityEntry> registry) {
		PortalEntities.registry = registry;

		register(EntityHEP.class, "hep", getRenderer("RenderEntityHEP"));
		register(EntityWheatley.class, "wheatley", getRenderer("RenderEntityWheatley"));
		register(EntityStorageCube.class, "storage_cube", getRenderer("RenderEntityCube"));
		register(EntityPivotCube.class, "pivot_cube", getRenderer("RenderEntityPivotCube"));
		register(EntityTurret.class, "turret", getRenderer("RenderEntityTurret"));
		register(EntityCamera.class, "camera", getRenderer("RenderEntityCamera"));
		
		addSpawnInfo("storage_cube");
		addSpawnInfo("pivot_cube");

	}

	private static void register(Class entityClass, String name, @Nullable Class renderClass) {
		registry.register(EntityEntryBuilder.create().entity(entityClass).tracker(160, 1, true)
				.id(new ResourceLocation(PortalReloaded.MODID, name), id++).name(name).build());
		if (renderClass != null)
			PortalReloaded.proxy.registerEntityRenderer(entityClass, renderClass);
	}

	private static Class getRenderer(String clss) {
		try {
			return Class.forName("com.cemi.portalreloaded.client.renderer.entity." + clss);
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
			return null;
		}
	}

	protected static EntityList.EntityEggInfo addSpawnInfo(String id) {
		ResourceLocation resourcelocation = new ResourceLocation(id);
		EntityList.EntityEggInfo egg = new EntityList.EntityEggInfo(resourcelocation, 0, 0);
		net.minecraftforge.fml.common.registry.EntityEntry entry = net.minecraftforge.fml.common.registry.ForgeRegistries.ENTITIES
				.getValue(resourcelocation);
		if (entry != null)
			entry.setEgg(egg);
		return (EntityList.EntityEggInfo) CUBE_PLACERS.put(resourcelocation, egg);
	}

}
